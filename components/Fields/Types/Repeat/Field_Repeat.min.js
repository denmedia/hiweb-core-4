var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,d){a instanceof String&&(a=String(a));for(var c=a.length,e=0;e<c;e++){var f=a[e];if(b.call(d,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,d,c){if(b){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in d||(d[e]={});d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6","es3");
var hiweb_field_repeat={selector:".hiweb-field-type-repeat",selector_source:"[data-row-source]",selector_wrap:"tbody.wrap",selector_row:"[data-row]",selector_button_add:"[data-action-add]",selector_button_clear:"[data-action-clear]",selector_button_remove:"[data-action-remove]",selector_button_duplicate:"[data-action-duplicate]",init:function(a){a=jQuery(a);0!==a.length&&a.is("[data-unique_id]")&&!a.is(".hiweb-field-type-repeat-init")&&(a.addClass("hiweb-field-type-repeat-init"),hiweb_field_repeat.init_buttons(a),
hiweb_field_repeat.init_sortable(a),hiweb_field_repeat.init_dropdown(a),hiweb_field_repeat.set_input_names(a))},init_buttons:function(a){var b=a.attr("data-unique_id");a.find('[data-action_add][data-unique_id="'+b+'"]').on("click",hiweb_field_repeat.click_add);a.on("click",'[data-action-remove][data-unique_id="'+b+'"]',hiweb_field_repeat.click_remove);a.find('[data-action_clear][data-unique_id="'+b+'"]').on("click",hiweb_field_repeat.click_clear_full)},init_dropdown:function(a){var b=a.attr("data-unique_id");
a.find('[data-dropdown="'+b+'"]').each(function(){var a=jQuery(this).find(".hiweb-fields-dropdown-menu"),b=jQuery(this).qtip({content:a,show:{event:"click",effect:function(a){jQuery(this).fadeIn(400)}},hide:{event:"unfocus click mouseclick",delay:100,effect:function(a){jQuery(this).fadeOut(400)}},style:{classes:"qtip-light qtip-shadow"},position:{my:"top center",at:"bottom center",viewport:!0,adjust:{method:"shift flip"}}});a.on("click","a",function(){b.qtip("hide")})})},init_sortable:function(a){var b=
hiweb_field_repeat.get_rows_list(a);"undefined"==typeof b.sortable?alert("\u041f\u043b\u0430\u0433\u0438\u043d jquery.ui.sortable.js \u043d\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d!"):(b.sortable.hasOwnProperty("destroy")&&b.sortable("destroy"),b.sortable({update:function(b,c){hiweb_field_repeat.set_input_names(jQuery(this).closest(hiweb_field_repeat.selector));c.placeholder.find("[data-col]").each(function(){jQuery(this).trigger("hiweb-field-repeat-drag-update",[jQuery(this),
jQuery(this).closest("[data-row]"),a])})},tolerance:"pointer",forcePlaceholderSize:!0,distance:3,handle:"> [data-drag-handle], > [data-drag-handle] button, > [data-drag-handle] i, > [data-drag-handle] svg",connectWith:'[data-rows_list="'+b.attr("data-rows_list")+'"]',helper:function(b,c){c.find("th, td").each(function(){jQuery(this).width(jQuery(this).width())});c.find("[data-col]").each(function(){jQuery(this).trigger("hiweb-field-repeat-dragged",[jQuery(this),jQuery(this).closest("[data-row]"),
a])});return c},revert:!0,start:function(a,b){b.placeholder.outerHeight(b.helper.outerHeight());a=b.placeholder.closest("table");var c=b.placeholder.closest(".hiweb-field-type-repeat");a.addClass("ui-sorting-process");c.css({"perspective-origin":"50% "+c.offset().top+"px"});b.helper.find("input[name], select[name], textarea[name], file[name]").trigger("hiweb-field-repeat-drag-start")},stop:function(a,b){b.item.closest("table").removeClass("ui-sorting-process");b.item.find("input[name], select[name], textarea[name], file[name]").trigger("hiweb-field-repeat-drag-stop")}}))},
click_add:function(a){a.preventDefault();var b=jQuery(this);a=b.is('[data-action_add="1"]');var d=b.attr("data-unique_id");b=b.is("[data-flex_id]")?b.attr("data-flex_id"):"";var c=jQuery('.hiweb-field-type-repeat[data-unique_id="'+d+'"]');hiweb_field_repeat.add_rows(c,a,1,"",b,d)},get_row_source:function(a){return jQuery(a).find("> table > tbody[data-rows-source] > tr[data-row]")},get_rows_list:function(a){return jQuery(a).find("> table > tbody[data-rows_list]")},get_rows:function(a){return jQuery(a).find("> table > tbody[data-rows_list] > tr[data-row]")},
get_cols:function(a){return jQuery(a).find("> table > thead [data-col]")},get_cols_by_row:function(a){return jQuery(a).find("> [data-col], > td > [data-col], > td > table > tbody > tr > [data-col]")},getRandomColor:function(){for(var a="#",b=0;6>b;b++)a+="0123456789ABCDEF"[Math.floor(16*Math.random())];return a},set_input_names:function(a){a=jQuery(a);a.find("[data-row]").each(function(){var a=jQuery(this),d=a.closest(".hiweb-field-type-repeat");jQuery(this).attr("data-row",d.find("> table > tbody > tr[data-row]").index(a))});
a.find(":input[name]").each(function(){jQuery(this).attr("name",hiweb_field_repeat.get_input_name(jQuery(this)))});a.find("> table > tbody[data-rows_message] [data-row_empty]").attr("data-row_empty",0<hiweb_field_repeat.get_rows(a).length?"1":"0")},get_input_name:function(a){a=jQuery(a);for(var b=[],d=10;0<d;){var c=a.closest("[data-col]");if(1!==c.length)return a.closest(".hiweb-field-type-repeat[data-global_id]").attr("data-global_id");a=(a.is(".hiweb-field-type-repeat")?a.attr("data-id"):a.attr("name")).split("["+
c.attr("data-col")+"]");1<a.length&&(a=a.pop(),""!==a&&b.push(a));b.push("["+c.attr("data-col")+"]");c=c.closest("[data-row]");if(1!==c.length){console.warn("2: row not found");break}b.push("["+c.attr("data-row")+"]");c=c.closest(".hiweb-field-type-repeat[data-global_id]");1!==c.length&&console.warn("3: repeat not found");var $super_col=c.closest("[data-col]");if(1!==$super_col.length){b.push(c.attr("data-input_name"));break}else a=c;d--}return b.reverse().join("")},get_global_id:function(a){return jQuery(a).is("[data-global_id]")?
jQuery(a).attr("data-global-_d"):jQuery(a).closest("[data-global_id]").attr("data-global_id")},get_name_id:function(a){return jQuery(a).is("[data-input-name]")?jQuery(a).data("input-name"):jQuery(a).closest("[data-input-name]").data("input-name")},add_rows:function(a,b,d,c,e,f){if(a.is(".hiweb-field-type-repeat")){"undefined"===typeof d&&(d=1);"undefined"===typeof b&&(b=!1);"undefined"===typeof e&&(e="");var g=hiweb_field_repeat.get_rows_list(a);c=b?0:hiweb_field_repeat.get_rows(a).length;jQuery.ajax({url:ajaxurl+
"?action=hiweb-field-repeat-get-row",type:"post",data:{id:a.attr("data-global_id"),method:"ajax_html_row",input_name:hiweb_field_repeat.get_name_id(a),index:c,flex_row_id:e,unique_id:f},dataType:"json",success:function(c){if(c.hasOwnProperty("result")&&!0===c.result){c=jQuery(c.data).hide().fadeIn();for(var e=0;e<d;e++)b?g.prepend(c):g.append(c),c.find("> td").wrapInner('<div style="display: none;" />').parent().find("> td > div").slideDown(400,function(){var a=jQuery(this),b=a.parent();a.replaceWith(a.contents());
b.find("input[name], select[name], textarea[name], file[name]").trigger("hiweb-field-repeat-added-row-fadein")}),hiweb_field_repeat.set_input_names(a),hiweb_field_repeat.init_buttons(c),c.closest(".hiweb-components-form-ajax-wrap").trigger("hiweb-field-repeat-added-row"),c.find("input[name], select[name], textarea[name], file[name]").trigger("hiweb-field-repeat-added-row")}else console.warn(c)},error:function(a){console.warn(a)}})}},paramsToArray:function(a,b){a=a.match(/(\[?[\d\w\-_]+\]?)/g);for(var d=
temp={},c=0;c<a.length;c++){var e=a[c].replace(/^\[?([\d\w\-_]+)\]?/,"$1");temp=c===a.length-1?temp[e]=b:temp[e]={}}return d},click_duplicate:function(a){},click_remove:function(a){a.preventDefault();a=jQuery(this).closest(hiweb_field_repeat.selector_row);hiweb_field_repeat.do_remove_row(a)},do_remove_row:function(a){return jQuery(a).find("> td").wrapInner('<div style="display: block;" />').parent().find("> td > div").slideUp(700,function(){var b=a.closest(".hiweb-field-type-repeat");jQuery(this).parent().parent().remove();
a.remove();hiweb_field_repeat.set_input_names(b);0===hiweb_field_repeat.get_rows(b).length&&jQuery(b).find("[data-row_empty]").attr("data-row_empty","0")})},click_clear_full:function(a){a.preventDefault();a=jQuery(this).attr("data-unique_id");a=jQuery('.hiweb-field-type-repeat[data-unique_id="'+a+'"]');0!==a.length&&confirm(a.attr("data-text_confirm_clear_all"))&&hiweb_field_repeat.get_rows(a).each(function(){hiweb_field_repeat.do_remove_row(jQuery(this))})}};jQuery(".hiweb-field-type-repeat").each(function(){hiweb_field_repeat.init(this)});
jQuery("body").on("hiweb-form-ajax-loaded hiweb-field-repeat-added-row",".hiweb-components-form-ajax-wrap",function(){jQuery(this).find(".hiweb-field-type-repeat").each(function(){hiweb_field_repeat.init(this)})});
