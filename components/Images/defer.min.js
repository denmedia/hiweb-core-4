var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,a,d){b instanceof String&&(b=String(b));for(var c=b.length,e=0;e<c;e++){var f=b[e];if(a.call(d,f,e,b))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,d){b!=Array.prototype&&b!=Object.prototype&&(b[a]=d.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,a,d,c){if(a){d=$jscomp.global;b=b.split(".");for(c=0;c<b.length-1;c++){var e=b[c];e in d||(d[e]={});d=d[e]}b=b[b.length-1];c=d[b];a=a(c);a!=c&&null!=a&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
jQuery(document).ready(function(b){if(0<b("[data-image-defer-id]").length){var a={is_receive_data:0,source_images_data:{},receive_images_html:{},receive_images_src:{},images_ids_queue:[],images_ids_processed:[],scroll_event_interval:200,scroll_event_handler:null,scroll_event_now:!1,queue_started:!1,queue_parallel_limit:5,queue_parallel_count:5,init:function(){a.make_events();var d=setInterval(function(){/loaded|complete/.test(document.readyState)&&(clearInterval(d),a.receive_images_data(a.find_images_on_windows),
b(document).on("ajaxComplete",function(){2===a.is_receive_data?a.is_receive_data=0:0===a.is_receive_data&&a.receive_images_data(a.find_images_on_windows)}))},100)},receive_images_data:function(d){a.is_receive_data=1;var c=b("[data-image-defer-id]");0!==c.length&&(c.each(function(){var d=b(this);a.source_images_data[d.attr("data-image-defer-id")]=JSON.parse(d.attr("data-image-defer"))}),b.ajax({url:hiweb_imageDefer_ajax_url,type:"post",dataType:"json",data:{images:a.source_images_data,usePictureHtml:hiweb_imageDefer_usePictureHtml,
useWidthHeightProps:hiweb_imageDefer_useWidthHeightProps},success:function(c){if(c.success){for(var e in c.images)a.receive_images_html.hasOwnProperty(e)||(a.receive_images_html[e]=c.images[e],a.receive_images_src[e]=c.images_src[e]);"function"===typeof d&&d()}b("body").append(c.js)},complete:function(){a.is_receive_data=2}}))},make_events:function(){b(window).scroll(function(b){a.scroll_event_now||(a.scroll_event_now=!0,clearTimeout(a.scroll_event_handler),a.scroll_event_handler=setTimeout(function(){a.find_images_on_windows();
a.queue_start();a.scroll_event_now=!1},a.scroll_event_interval))})},find_images_on_windows:function(){var d=b(window).scrollTop()+window.innerHeight,c;for(c in a.receive_images_html)if(!(-1<a.images_ids_queue.indexOf(c)||-1<a.images_ids_processed.indexOf(c))){var e=b('[data-image-defer-id="'+c+'"][data-image-defer-status="preload"]'),f=0<e.find("img").length?e.find("img").offset().top:e.offset().top;0<e.length&&f<d+e.height()-100&&(a.images_ids_queue.push(c),a.queue_start())}},queue_start:function(){if(!a.queue_started){a.queue_started=
!0;for(var b=0;b<a.queue_parallel_limit;b++)a.queue_next(),a.queue_parallel_count++}},queue_next:function(){if(a.queue_started||!(a.queue_parallel_count>=a.queue_parallel_limit))if(0===a.images_ids_queue.length)a.queue_started=!1,a.queue_parallel_count=0;else{var b=a.images_ids_queue.shift();a.images_ids_processed.push(b);a.load_image(b,a.queue_next)}},load_image:function(d,c){if(a.receive_images_html.hasOwnProperty(d)){var e=b('[data-image-defer-id="'+d+'"]');if(0<e.length){e.attr("data-image-defer-status",
"loading");var f=a.receive_images_src[d],g=f.length;if(0===g&&"function"===typeof c)return c();for(var k in f){var h=new Image;h.onload=function(){g--;1>g&&"function"===typeof c&&(e.replaceWith(b(a.receive_images_html[d]).attr("data-image-defer-status","loaded")),c())};h.onerror=function(){g--;1>g&&"function"===typeof c&&c()};h.src=f[k]}}}}};a.init()}});
