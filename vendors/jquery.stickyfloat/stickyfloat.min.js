/*
       Copyright (c) 2013
 @license         MIT and GPL licenses.
 @link            http://dropthebit.com
 @version         Version 8.8
 @parameters      duration        (number, 200)    - the duration of the animation
                    startOffset     (number)         - the amount of scroll offset after the animations kicks in
                    offsetY         (number)         - the offset from the top when the object is animated
                    lockBottom      (boolean, true)  - set to false if you don't want your floating box to stop at parent's bottom
                    delay           (number, 0)      - delay in milliseconds until the animation starts
                    easing          (string, linear) - easing function (jQuery has by default only 'swing' & 'linear')
                    stickToBottom   (boolean, false) - to make the element stick to the bottom instead to the top
     onReposition    (function)       - a callback to be invoked when the floated element is repositioned
     scrollArea      (DOM element, window) - The element which stickyfloat should track it's scroll position (for situations with inner scroll)

   @example         Example: jQuery('#menu').stickyfloat({duration: 400});

*/
(function(d){function g(a){a=a.parent();var e=parseInt(a.css("padding-bottom")),c=parseInt(a.css("padding-top"));return{startOffset:a.offset().top,offsetBottom:e,offsetY:c}}var f=window,l=document,h,m={scrollArea:f,duration:200,lockBottom:!0,delay:0,easing:"linear",stickToBottom:!1,cssTransition:!1},p=function(){var a,e=l.createElement("p").style,c=["ms","O","Moz","Webkit"],b="transition";if(""==e[b])return!0;b=b.charAt(0).toUpperCase()+b.slice(1);for(a=c.length;a--;)if(""==e[c[a]+b])return!0;return!1}(),
k=function(a,e){this.settings=a;this.obj=d(e)};k.prototype={init:function(){if(this.obj.data("_stickyfloat"))return!1;var a=this,e=f.requestAnimationFrame||f.webkitRequestAnimationFrame||f.mozRequestAnimationFrame||f.msRequestAnimationFrame||function(a){return f.setTimeout(a,1E3/60)};d(f).ready(function(){a.rePosition(!0);d(a.settings.scrollArea).on("scroll.sticky",function(){e(d.proxy(a.rePosition,a))});d(f).on("resize.sticky",function(){e(d.proxy(a.rePosition,a))})});this.obj.data("_stickyfloat",
a)},rePosition:function(a,e){var c=this.obj,b=this.settings,d=!0===a?0:b.duration,g=!0,n=this.settings.scrollArea==f?f.scrollY?f.scrollY:l.documentElement.scrollTop:this.settings.scrollArea.scrollTop;this.areaViewportHeight=this.settings.scrollArea==f?l.documentElement.clientHeight:this.settings.scrollArea.clientHeight;this.stickyHeight=c[0].clientHeight;c.stop();b.lockBottom&&(h=c[0].parentNode.clientHeight-this.stickyHeight-b.offsetBottom);0>h&&(h=0);var k=n>b.startOffset;var m=c.offset().top>b.startOffset+
b.offsetY;a=this.stickyHeight>this.areaViewportHeight;if((k||m)&&!a||e)this.newpos=n-b.startOffset+b.offsetY,b.stickToBottom&&(this.newpos+=this.areaViewportHeight-this.stickyHeight-2*b.offsetY),this.newpos>h&&b.lockBottom&&(this.newpos=h,g=!1),this.newpos<b.offsetY?(this.newpos=b.offsetY,g=!1):n<b.startOffset&&!b.stickToBottom&&(this.newpos=b.offsetY),c.toggleClass("sf--active",g),5>d||b.cssTransition&&p?c[0].style.top=this.newpos+"px":c.stop().delay(b.delay).animate({top:this.newpos},d,b.easing),
this.settings.onReposition&&this.settings.onReposition(this)},update:function(a){"object"===typeof a&&(a.offsetY&&"auto"!=a.offsetY||(a.offsetY=g(this.obj).offsetY),a.startOffset&&"auto"!=a.startOffset||(a.startOffset=g(this.obj).startOffset),this.settings=d.extend({},this.settings,a),this.rePosition(!1,!0));return this.obj},destroy:function(){d(this.settings.scrollArea).off("scroll.sticky");d(f).off("resize.sticky");this.obj.removeData();return this.obj}};d.fn.stickyfloat=function(a,e){return this.each(function(){var c=
d(this);if("undefined"==typeof document.body.style.maxHeight)return!1;if("object"===typeof a)e=a;else if("string"===typeof a)return c.data("_stickyfloat")&&"function"==typeof c.data("_stickyfloat")[a]?(c=c.data("_stickyfloat"),c[a](e)):this;var b=d.extend({},m,g(c),e||{});c=new k(b,c);c.init()})}})(jQuery);
